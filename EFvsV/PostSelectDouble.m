%%
%filelist={'07-27-2016_ 0_07_06_TopA';'07-27-2016_ 0_07_06_TopB';'07-27-2016_ 0_06_14_TopA';'07-27-2016_ 0_06_14_TopB';'07-27-2016_ 0_05_22_TopA';'07-27-2016_ 0_05_22_TopB';'07-27-2016_ 0_04_30_TopA';'07-27-2016_ 0_04_30_TopB';'07-27-2016_ 0_03_38_TopA';'07-27-2016_ 0_03_38_TopB';'07-27-2016_ 0_02_46_TopA';'07-27-2016_ 0_02_46_TopB';'07-27-2016_ 0_01_54_TopA';'07-27-2016_ 0_01_54_TopB';'07-27-2016_ 0_01_02_TopA';'07-27-2016_ 0_01_02_TopB';'07-27-2016_ 0_00_10_TopA';'07-27-2016_ 0_00_10_TopB';'07-26-2016_23_59_18_TopA';'07-26-2016_23_59_18_TopB';'07-26-2016_23_58_26_TopA';'07-26-2016_23_58_26_TopB';'07-26-2016_23_57_34_TopA';'07-26-2016_23_57_34_TopB';'07-26-2016_23_56_43_TopA';'07-26-2016_23_56_43_TopB';'07-26-2016_23_55_50_TopA';'07-26-2016_23_55_50_TopB';'07-26-2016_23_54_59_TopA';'07-26-2016_23_54_59_TopB';'07-26-2016_23_54_07_TopA';'07-26-2016_23_54_07_TopB';'07-26-2016_23_53_15_TopA';'07-26-2016_23_53_15_TopB';'07-26-2016_23_52_23_TopA';'07-26-2016_23_52_23_TopB';'07-26-2016_23_51_31_TopA';'07-26-2016_23_51_31_TopB';'07-26-2016_23_50_39_TopA';'07-26-2016_23_50_39_TopB';'07-26-2016_23_49_47_TopA';'07-26-2016_23_49_47_TopB';'07-26-2016_23_48_56_TopA';'07-26-2016_23_48_56_TopB';'07-26-2016_23_48_04_TopA';'07-26-2016_23_48_04_TopB';'07-26-2016_23_47_12_TopA';'07-26-2016_23_47_12_TopB';'07-26-2016_23_46_20_TopA';'07-26-2016_23_46_20_TopB';'07-26-2016_23_45_28_TopA';'07-26-2016_23_45_28_TopB';'07-26-2016_23_44_36_TopA';'07-26-2016_23_44_36_TopB';'07-26-2016_23_43_44_TopA';'07-26-2016_23_43_44_TopB';'07-26-2016_23_42_52_TopA';'07-26-2016_23_42_52_TopB';'07-26-2016_23_41_25_TopA';'07-26-2016_23_41_25_TopB';'07-26-2016_23_40_33_TopA';'07-26-2016_23_40_33_TopB';'07-26-2016_23_39_41_TopA';'07-26-2016_23_39_41_TopB';'07-26-2016_23_38_50_TopA';'07-26-2016_23_38_50_TopB';'07-26-2016_23_37_58_TopA';'07-26-2016_23_37_58_TopB';'07-26-2016_23_37_06_TopA';'07-26-2016_23_37_06_TopB';'07-26-2016_23_36_14_TopA';'07-26-2016_23_36_14_TopB';'07-26-2016_23_35_22_TopA';'07-26-2016_23_35_22_TopB';'07-26-2016_23_34_30_TopA';'07-26-2016_23_34_30_TopB';'07-26-2016_23_33_38_TopA';'07-26-2016_23_33_38_TopB';'07-26-2016_23_32_18_TopA';'07-26-2016_23_32_18_TopB'};
%filelist={'07-26-2016_23_31_17_TopA';'07-26-2016_23_31_17_TopB';'07-26-2016_23_30_25_TopA';'07-26-2016_23_30_25_TopB';'07-26-2016_23_29_33_TopA';'07-26-2016_23_29_33_TopB';'07-26-2016_23_28_41_TopA';'07-26-2016_23_28_41_TopB';'07-26-2016_23_27_49_TopA';'07-26-2016_23_27_49_TopB';'07-26-2016_23_26_57_TopA';'07-26-2016_23_26_57_TopB';'07-26-2016_23_26_06_TopA';'07-26-2016_23_26_06_TopB';'07-26-2016_23_25_14_TopA';'07-26-2016_23_25_14_TopB';'07-26-2016_23_24_22_TopA';'07-26-2016_23_24_22_TopB';'07-26-2016_23_23_30_TopA';'07-26-2016_23_23_30_TopB';'07-26-2016_23_22_38_TopA';'07-26-2016_23_22_38_TopB';'07-26-2016_23_21_46_TopA';'07-26-2016_23_21_46_TopB';'07-26-2016_23_20_54_TopA';'07-26-2016_23_20_54_TopB';'07-26-2016_23_20_02_TopA';'07-26-2016_23_20_02_TopB';'07-26-2016_23_19_11_TopA';'07-26-2016_23_19_11_TopB';'07-26-2016_23_18_19_TopA';'07-26-2016_23_18_19_TopB'};
%filelist={'07-26-2016_23_16_13_TopA';'07-26-2016_23_16_13_TopB';'07-26-2016_23_15_21_TopA';'07-26-2016_23_15_21_TopB';'07-26-2016_23_14_29_TopA';'07-26-2016_23_14_29_TopB';'07-26-2016_23_13_37_TopA';'07-26-2016_23_13_37_TopB';'07-26-2016_23_12_45_TopA';'07-26-2016_23_12_45_TopB';'07-26-2016_23_11_54_TopA';'07-26-2016_23_11_54_TopB';'07-26-2016_23_11_02_TopA';'07-26-2016_23_11_02_TopB';'07-26-2016_23_10_10_TopA';'07-26-2016_23_10_10_TopB';'07-26-2016_23_08_57_TopA';'07-26-2016_23_08_57_TopB'};
%filelist={'08-02-2016_19_52_09_TopA';'08-02-2016_19_52_09_TopB';'08-02-2016_19_51_17_TopA';'08-02-2016_19_51_17_TopB';'08-02-2016_19_50_25_TopA';'08-02-2016_19_50_25_TopB';'08-02-2016_19_49_33_TopA';'08-02-2016_19_49_33_TopB';'08-02-2016_19_48_41_TopA';'08-02-2016_19_48_41_TopB';'08-02-2016_19_47_49_TopA';'08-02-2016_19_47_49_TopB';'08-02-2016_19_46_57_TopA';'08-02-2016_19_46_57_TopB';'08-02-2016_19_46_05_TopA';'08-02-2016_19_46_05_TopB';'08-02-2016_19_45_13_TopA';'08-02-2016_19_45_13_TopB';'08-02-2016_19_44_21_TopA';'08-02-2016_19_44_21_TopB';'08-02-2016_19_43_29_TopA';'08-02-2016_19_43_29_TopB';'08-02-2016_19_42_37_TopA';'08-02-2016_19_42_37_TopB';'08-02-2016_19_41_18_TopA';'08-02-2016_19_41_18_TopB';'08-02-2016_19_40_26_TopA';'08-02-2016_19_40_26_TopB'};
%filelist={'08-05-2016_03_07_10_TopA';'08-05-2016_03_07_10_TopB';'08-05-2016_03_06_18_TopA';'08-05-2016_03_06_18_TopB';'08-05-2016_03_05_26_TopA';'08-05-2016_03_05_26_TopB';'08-05-2016_03_04_06_TopA';'08-05-2016_03_04_06_TopB';'08-05-2016_03_02_44_TopA';'08-05-2016_03_02_44_TopB';'08-05-2016_03_01_52_TopA';'08-05-2016_03_01_52_TopB';'08-05-2016_03_01_00_TopA';'08-05-2016_03_01_00_TopB';'08-05-2016_03_00_08_TopA';'08-05-2016_03_00_08_TopB';'08-05-2016_02_59_16_TopA';'08-05-2016_02_59_16_TopB';'08-05-2016_02_58_24_TopA';'08-05-2016_02_58_24_TopB';'08-05-2016_02_57_32_TopA';'08-05-2016_02_57_32_TopB';'08-05-2016_02_56_22_TopA';'08-05-2016_02_56_22_TopB'};
%filelist={'08-05-2016_03_26_47_TopA';'08-05-2016_03_26_47_TopB';'08-05-2016_03_25_55_TopA';'08-05-2016_03_25_55_TopB';'08-05-2016_03_25_03_TopA';'08-05-2016_03_25_03_TopB';'08-05-2016_03_24_11_TopA';'08-05-2016_03_24_11_TopB';'08-05-2016_03_23_19_TopA';'08-05-2016_03_23_19_TopB';'08-05-2016_03_22_27_TopA';'08-05-2016_03_22_27_TopB';'08-05-2016_03_21_35_TopA';'08-05-2016_03_21_35_TopB';'08-05-2016_03_20_43_TopA';'08-05-2016_03_20_43_TopB';'08-05-2016_03_19_51_TopA';'08-05-2016_03_19_51_TopB';'08-05-2016_03_16_23_TopA';'08-05-2016_03_16_23_TopB';'08-05-2016_03_14_58_TopA';'08-05-2016_03_14_58_TopB';'08-05-2016_03_14_06_TopA';'08-05-2016_03_14_06_TopB';'08-05-2016_03_13_14_TopA';'08-05-2016_03_13_14_TopB';'08-05-2016_03_12_22_TopA';'08-05-2016_03_12_22_TopB';'08-05-2016_03_11_30_TopA';'08-05-2016_03_11_30_TopB'};
%filelist={'08-05-2016_03_44_07_TopA';'08-05-2016_03_44_07_TopB';'08-05-2016_03_43_15_TopA';'08-05-2016_03_43_15_TopB';'08-05-2016_03_42_23_TopA';'08-05-2016_03_42_23_TopB';'08-05-2016_03_41_31_TopA';'08-05-2016_03_41_31_TopB';'08-05-2016_03_40_39_TopA';'08-05-2016_03_40_39_TopB';'08-05-2016_03_39_46_TopA';'08-05-2016_03_39_46_TopB';'08-05-2016_03_38_55_TopA';'08-05-2016_03_38_55_TopB';'08-05-2016_03_38_03_TopA';'08-05-2016_03_38_03_TopB';'08-05-2016_03_37_11_TopA';'08-05-2016_03_37_11_TopB';'08-05-2016_03_36_19_TopA';'08-05-2016_03_36_19_TopB';'08-05-2016_03_35_27_TopA';'08-05-2016_03_35_27_TopB';'08-05-2016_03_34_35_TopA';'08-05-2016_03_34_35_TopB';'08-05-2016_03_33_43_TopA';'08-05-2016_03_33_43_TopB';'08-05-2016_03_32_51_TopA';'08-05-2016_03_32_51_TopB';'08-05-2016_03_31_59_TopA';'08-05-2016_03_31_59_TopB';'08-05-2016_03_30_15_TopA';'08-05-2016_03_30_15_TopB';'08-05-2016_03_29_23_TopA';'08-05-2016_03_29_23_TopB';'08-05-2016_03_28_31_TopA';'08-05-2016_03_28_31_TopB';'08-05-2016_03_27_39_TopA';'08-05-2016_03_27_39_TopB'};
%filelist={'08-05-2016_04_01_27_TopA';'08-05-2016_04_01_27_TopB';'08-05-2016_04_00_35_TopA';'08-05-2016_04_00_35_TopB';'08-05-2016_03_59_43_TopA';'08-05-2016_03_59_43_TopB';'08-05-2016_03_58_51_TopA';'08-05-2016_03_58_51_TopB';'08-05-2016_03_57_59_TopA';'08-05-2016_03_57_59_TopB';'08-05-2016_03_57_07_TopA';'08-05-2016_03_57_07_TopB';'08-05-2016_03_56_15_TopA';'08-05-2016_03_56_15_TopB';'08-05-2016_03_55_23_TopA';'08-05-2016_03_55_23_TopB';'08-05-2016_03_54_31_TopA';'08-05-2016_03_54_31_TopB';'08-05-2016_03_53_39_TopA';'08-05-2016_03_53_39_TopB';'08-05-2016_03_52_47_TopA';'08-05-2016_03_52_47_TopB';'08-05-2016_03_51_55_TopA';'08-05-2016_03_51_55_TopB';'08-05-2016_03_51_02_TopA';'08-05-2016_03_51_02_TopB';'08-05-2016_03_50_11_TopA';'08-05-2016_03_50_11_TopB';'08-05-2016_03_49_19_TopA';'08-05-2016_03_49_19_TopB';'08-05-2016_03_48_27_TopA';'08-05-2016_03_48_27_TopB';'08-05-2016_03_47_35_TopA';'08-05-2016_03_47_35_TopB';'08-05-2016_03_46_43_TopA';'08-05-2016_03_46_43_TopB';'08-05-2016_03_45_51_TopA';'08-05-2016_03_45_51_TopB';'08-05-2016_03_44_59_TopA';'08-05-2016_03_44_59_TopB'};
%filelist={'08-05-2016_04_20_32_TopA';'08-05-2016_04_20_32_TopB';'08-05-2016_04_19_40_TopA';'08-05-2016_04_19_40_TopB';'08-05-2016_04_18_48_TopA';'08-05-2016_04_18_48_TopB';'08-05-2016_04_17_56_TopA';'08-05-2016_04_17_56_TopB';'08-05-2016_04_17_04_TopA';'08-05-2016_04_17_04_TopB';'08-05-2016_04_16_12_TopA';'08-05-2016_04_16_12_TopB';'08-05-2016_04_15_20_TopA';'08-05-2016_04_15_20_TopB';'08-05-2016_04_14_28_TopA';'08-05-2016_04_14_28_TopB';'08-05-2016_04_13_36_TopA';'08-05-2016_04_13_36_TopB';'08-05-2016_04_12_44_TopA';'08-05-2016_04_12_44_TopB';'08-05-2016_04_11_52_TopA';'08-05-2016_04_11_52_TopB';'08-05-2016_04_11_00_TopA';'08-05-2016_04_11_00_TopB';'08-05-2016_04_10_08_TopA';'08-05-2016_04_10_08_TopB';'08-05-2016_04_09_16_TopA';'08-05-2016_04_09_16_TopB'};
%filelist={'08-05-2016_04_35_16_TopA';'08-05-2016_04_35_16_TopB';'08-05-2016_04_34_24_TopA';'08-05-2016_04_34_24_TopB';'08-05-2016_04_33_32_TopA';'08-05-2016_04_33_32_TopB';'08-05-2016_04_32_40_TopA';'08-05-2016_04_32_40_TopB';'08-05-2016_04_31_48_TopA';'08-05-2016_04_31_48_TopB';'08-05-2016_04_30_56_TopA';'08-05-2016_04_30_56_TopB';'08-05-2016_04_30_04_TopA';'08-05-2016_04_30_04_TopB';'08-05-2016_04_29_12_TopA';'08-05-2016_04_29_12_TopB';'08-05-2016_04_28_20_TopA';'08-05-2016_04_28_20_TopB';'08-05-2016_04_27_28_TopA';'08-05-2016_04_27_28_TopB';'08-05-2016_04_26_36_TopA';'08-05-2016_04_26_36_TopB';'08-05-2016_04_25_44_TopA';'08-05-2016_04_25_44_TopB';'08-05-2016_04_24_52_TopA';'08-05-2016_04_24_52_TopB';'08-05-2016_04_24_00_TopA';'08-05-2016_04_24_00_TopB';'08-05-2016_04_23_08_TopA';'08-05-2016_04_23_08_TopB';'08-05-2016_04_22_16_TopA';'08-05-2016_04_22_16_TopB'};
%filelist={'08-05-2016_05_03_03_TopA';'08-05-2016_05_03_03_TopB';'08-05-2016_05_02_10_TopA';'08-05-2016_05_02_10_TopB';'08-05-2016_05_01_19_TopA';'08-05-2016_05_01_19_TopB';'08-05-2016_05_00_27_TopA';'08-05-2016_05_00_27_TopB';'08-05-2016_04_59_35_TopA';'08-05-2016_04_59_35_TopB';'08-05-2016_04_58_43_TopA';'08-05-2016_04_58_43_TopB';'08-05-2016_04_57_51_TopA';'08-05-2016_04_57_51_TopB';'08-05-2016_04_56_59_TopA';'08-05-2016_04_56_59_TopB';'08-05-2016_04_56_07_TopA';'08-05-2016_04_56_07_TopB';'08-05-2016_04_55_15_TopA';'08-05-2016_04_55_15_TopB';'08-05-2016_04_54_23_TopA';'08-05-2016_04_54_23_TopB';'08-05-2016_04_53_31_TopA';'08-05-2016_04_53_31_TopB';'08-05-2016_04_52_39_TopA';'08-05-2016_04_52_39_TopB';'08-05-2016_04_51_47_TopA';'08-05-2016_04_51_47_TopB';'08-05-2016_04_50_55_TopA';'08-05-2016_04_50_55_TopB';'08-05-2016_04_50_03_TopA';'08-05-2016_04_50_03_TopB';'08-05-2016_04_49_11_TopA';'08-05-2016_04_49_11_TopB';'08-05-2016_04_48_19_TopA';'08-05-2016_04_48_19_TopB';'08-05-2016_04_47_27_TopA';'08-05-2016_04_47_27_TopB';'08-05-2016_04_46_35_TopA';'08-05-2016_04_46_35_TopB';'08-05-2016_04_45_43_TopA';'08-05-2016_04_45_43_TopB';'08-05-2016_04_44_51_TopA';'08-05-2016_04_44_51_TopB';'08-05-2016_04_43_38_TopA';'08-05-2016_04_43_38_TopB';'08-05-2016_04_42_46_TopA';'08-05-2016_04_42_46_TopB';'08-05-2016_04_41_22_TopA';'08-05-2016_04_41_22_TopB';'08-05-2016_04_40_30_TopA';'08-05-2016_04_40_30_TopB';'08-05-2016_04_38_37_TopA';'08-05-2016_04_38_37_TopB'};
%filelist={'08-05-2016_05_28_25_TopA';'08-05-2016_05_28_25_TopB';'08-05-2016_05_27_33_TopA';'08-05-2016_05_27_33_TopB';'08-05-2016_05_26_41_TopA';'08-05-2016_05_26_41_TopB';'08-05-2016_05_25_49_TopA';'08-05-2016_05_25_49_TopB';'08-05-2016_05_24_57_TopA';'08-05-2016_05_24_57_TopB';'08-05-2016_05_24_05_TopA';'08-05-2016_05_24_05_TopB';'08-05-2016_05_23_13_TopA';'08-05-2016_05_23_13_TopB';'08-05-2016_05_22_21_TopA';'08-05-2016_05_22_21_TopB';'08-05-2016_05_21_29_TopA';'08-05-2016_05_21_29_TopB';'08-05-2016_05_20_37_TopA';'08-05-2016_05_20_37_TopB';'08-05-2016_05_19_45_TopA';'08-05-2016_05_19_45_TopB';'08-05-2016_05_18_53_TopA';'08-05-2016_05_18_53_TopB';'08-05-2016_05_18_01_TopA';'08-05-2016_05_18_01_TopB';'08-05-2016_05_17_09_TopA';'08-05-2016_05_17_09_TopB'};
%filelist={'08-04-2016_23_34_26_TopA';'08-04-2016_23_34_26_TopB';'08-04-2016_23_33_35_TopA';'08-04-2016_23_33_35_TopB';'08-04-2016_23_32_42_TopA';'08-04-2016_23_32_42_TopB';'08-04-2016_23_31_51_TopA';'08-04-2016_23_31_51_TopB';'08-04-2016_23_30_07_TopA';'08-04-2016_23_30_07_TopB';'08-04-2016_23_29_15_TopA';'08-04-2016_23_29_15_TopB';'08-04-2016_23_28_23_TopA';'08-04-2016_23_28_23_TopB';'08-04-2016_23_27_31_TopA';'08-04-2016_23_27_31_TopB';'08-04-2016_23_26_39_TopA';'08-04-2016_23_26_39_TopB';'08-04-2016_23_25_47_TopA';'08-04-2016_23_25_47_TopB';'08-04-2016_23_24_55_TopA';'08-04-2016_23_24_55_TopB';'08-04-2016_23_24_03_TopA';'08-04-2016_23_24_03_TopB';'08-04-2016_23_23_11_TopA';'08-04-2016_23_23_11_TopB';'08-04-2016_23_22_19_TopA';'08-04-2016_23_22_19_TopB';'08-04-2016_23_21_27_TopA';'08-04-2016_23_21_27_TopB';'08-04-2016_23_20_35_TopA';'08-04-2016_23_20_35_TopB';'08-04-2016_23_19_43_TopA';'08-04-2016_23_19_43_TopB';'08-04-2016_23_18_51_TopA';'08-04-2016_23_18_51_TopB';'08-04-2016_23_17_59_TopA';'08-04-2016_23_17_59_TopB';'08-04-2016_23_17_07_TopA';'08-04-2016_23_17_07_TopB';'08-04-2016_23_16_15_TopA';'08-04-2016_23_16_15_TopB';'08-04-2016_23_15_08_TopA';'08-04-2016_23_15_08_TopB'};
%filelist={'08-05-2016_00_26_53_TopA';'08-05-2016_00_26_53_TopB';'08-05-2016_00_26_01_TopA';'08-05-2016_00_26_01_TopB';'08-05-2016_00_25_09_TopA';'08-05-2016_00_25_09_TopB';'08-05-2016_00_24_18_TopA';'08-05-2016_00_24_18_TopB';'08-05-2016_00_23_25_TopA';'08-05-2016_00_23_25_TopB';'08-05-2016_00_22_33_TopA';'08-05-2016_00_22_33_TopB';'08-05-2016_00_21_42_TopA';'08-05-2016_00_21_42_TopB';'08-05-2016_00_20_50_TopA';'08-05-2016_00_20_50_TopB';'08-05-2016_00_19_57_TopA';'08-05-2016_00_19_57_TopB';'08-05-2016_00_19_05_TopA';'08-05-2016_00_19_05_TopB';'08-05-2016_00_18_14_TopA';'08-05-2016_00_18_14_TopB';'08-05-2016_00_17_22_TopA';'08-05-2016_00_17_22_TopB';'08-05-2016_00_16_30_TopA';'08-05-2016_00_16_30_TopB';'08-05-2016_00_15_37_TopA';'08-05-2016_00_15_37_TopB';'08-05-2016_00_14_46_TopA';'08-05-2016_00_14_46_TopB';'08-05-2016_00_13_54_TopA';'08-05-2016_00_13_54_TopB';'08-05-2016_00_13_02_TopA';'08-05-2016_00_13_02_TopB';'08-05-2016_00_12_10_TopA';'08-05-2016_00_12_10_TopB';'08-05-2016_00_11_18_TopA';'08-05-2016_00_11_18_TopB';'08-05-2016_00_10_26_TopA';'08-05-2016_00_10_26_TopB';'08-05-2016_00_09_34_TopA';'08-05-2016_00_09_34_TopB';'08-05-2016_00_08_42_TopA';'08-05-2016_00_08_42_TopB';'08-05-2016_00_07_50_TopA';'08-05-2016_00_07_50_TopB';'08-05-2016_00_05_14_TopA';'08-05-2016_00_05_14_TopB';'08-05-2016_00_04_22_TopA';'08-05-2016_00_04_22_TopB';'08-05-2016_00_03_30_TopA';'08-05-2016_00_03_30_TopB';'08-05-2016_00_02_38_TopA';'08-05-2016_00_02_38_TopB';'08-05-2016_00_00_54_TopA';'08-05-2016_00_00_54_TopB';'08-05-2016_00_00_02_TopA';'08-05-2016_00_00_02_TopB';'08-04-2016_23_59_10_TopA';'08-04-2016_23_59_10_TopB';'08-04-2016_23_58_18_TopA';'08-04-2016_23_58_18_TopB';'08-04-2016_23_57_26_TopA';'08-04-2016_23_57_26_TopB';'08-04-2016_23_56_34_TopA';'08-04-2016_23_56_34_TopB';'08-04-2016_23_55_42_TopA';'08-04-2016_23_55_42_TopB';'08-04-2016_23_54_50_TopA';'08-04-2016_23_54_50_TopB';'08-04-2016_23_53_58_TopA';'08-04-2016_23_53_58_TopB';'08-04-2016_23_53_06_TopA';'08-04-2016_23_53_06_TopB';'08-04-2016_23_52_14_TopA';'08-04-2016_23_52_14_TopB';'08-04-2016_23_51_22_TopA';'08-04-2016_23_51_22_TopB';'08-04-2016_23_50_30_TopA';'08-04-2016_23_50_30_TopB';'08-04-2016_23_48_05_TopA';'08-04-2016_23_48_05_TopB';'08-04-2016_23_47_13_TopA';'08-04-2016_23_47_13_TopB';'08-04-2016_23_46_21_TopA';'08-04-2016_23_46_21_TopB';'08-04-2016_23_45_29_TopA';'08-04-2016_23_45_29_TopB';'08-04-2016_23_44_37_TopA';'08-04-2016_23_44_37_TopB';'08-04-2016_23_43_45_TopA';'08-04-2016_23_43_45_TopB';'08-04-2016_23_42_53_TopA';'08-04-2016_23_42_53_TopB';'08-04-2016_23_42_01_TopA';'08-04-2016_23_42_01_TopB';'08-04-2016_23_41_09_TopA';'08-04-2016_23_41_09_TopB';'08-04-2016_23_40_17_TopA';'08-04-2016_23_40_17_TopB';'08-04-2016_23_39_25_TopA';'08-04-2016_23_39_25_TopB';'08-04-2016_23_38_22_TopA';'08-04-2016_23_38_22_TopB'};
%filelist={'08-05-2016_00_59_56_TopA';'08-05-2016_00_59_56_TopB';'08-05-2016_00_59_04_TopA';'08-05-2016_00_59_04_TopB';'08-05-2016_00_58_12_TopA';'08-05-2016_00_58_12_TopB';'08-05-2016_00_57_20_TopA';'08-05-2016_00_57_20_TopB';'08-05-2016_00_56_28_TopA';'08-05-2016_00_56_28_TopB';'08-05-2016_00_55_36_TopA';'08-05-2016_00_55_36_TopB';'08-05-2016_00_54_44_TopA';'08-05-2016_00_54_44_TopB';'08-05-2016_00_53_52_TopA';'08-05-2016_00_53_52_TopB';'08-05-2016_00_52_30_TopA';'08-05-2016_00_52_30_TopB';'08-05-2016_00_51_38_TopA';'08-05-2016_00_51_38_TopB';'08-05-2016_00_50_46_TopA';'08-05-2016_00_50_46_TopB';'08-05-2016_00_49_54_TopA';'08-05-2016_00_49_54_TopB';'08-05-2016_00_49_02_TopA';'08-05-2016_00_49_02_TopB';'08-05-2016_00_48_10_TopA';'08-05-2016_00_48_10_TopB';'08-05-2016_00_47_18_TopA';'08-05-2016_00_47_18_TopB';'08-05-2016_00_46_26_TopA';'08-05-2016_00_46_26_TopB';'08-05-2016_00_45_34_TopA';'08-05-2016_00_45_34_TopB';'08-05-2016_00_44_42_TopA';'08-05-2016_00_44_42_TopB';'08-05-2016_00_43_50_TopA';'08-05-2016_00_43_50_TopB';'08-05-2016_00_42_58_TopA';'08-05-2016_00_42_58_TopB';'08-05-2016_00_42_06_TopA';'08-05-2016_00_42_06_TopB';'08-05-2016_00_41_14_TopA';'08-05-2016_00_41_14_TopB';'08-05-2016_00_40_22_TopA';'08-05-2016_00_40_22_TopB';'08-05-2016_00_39_30_TopA';'08-05-2016_00_39_30_TopB';'08-05-2016_00_38_19_TopA';'08-05-2016_00_38_19_TopB'};
%filelist={'08-05-2016_02_00_07_TopA';'08-05-2016_02_00_07_TopB';'08-05-2016_01_59_16_TopA';'08-05-2016_01_59_16_TopB';'08-05-2016_01_58_24_TopA';'08-05-2016_01_58_24_TopB';'08-05-2016_01_57_31_TopA';'08-05-2016_01_57_31_TopB';'08-05-2016_01_56_40_TopA';'08-05-2016_01_56_40_TopB';'08-05-2016_01_55_48_TopA';'08-05-2016_01_55_48_TopB';'08-05-2016_01_54_56_TopA';'08-05-2016_01_54_56_TopB';'08-05-2016_01_54_03_TopA';'08-05-2016_01_54_03_TopB';'08-05-2016_01_53_11_TopA';'08-05-2016_01_53_11_TopB';'08-05-2016_01_52_20_TopA';'08-05-2016_01_52_20_TopB';'08-05-2016_01_51_28_TopA';'08-05-2016_01_51_28_TopB';'08-05-2016_01_50_24_TopA';'08-05-2016_01_50_24_TopB';'08-05-2016_01_49_32_TopA';'08-05-2016_01_49_32_TopB';'08-05-2016_01_48_25_TopA';'08-05-2016_01_48_25_TopB';'08-05-2016_01_47_33_TopA';'08-05-2016_01_47_33_TopB';'08-05-2016_01_46_41_TopA';'08-05-2016_01_46_41_TopB';'08-05-2016_01_45_49_TopA';'08-05-2016_01_45_49_TopB';'08-05-2016_01_44_57_TopA';'08-05-2016_01_44_57_TopB';'08-05-2016_01_44_05_TopA';'08-05-2016_01_44_05_TopB';'08-05-2016_01_42_38_TopA';'08-05-2016_01_42_38_TopB';'08-05-2016_01_41_46_TopA';'08-05-2016_01_41_46_TopB';'08-05-2016_01_40_54_TopA';'08-05-2016_01_40_54_TopB';'08-05-2016_01_40_02_TopA';'08-05-2016_01_40_02_TopB';'08-05-2016_01_39_10_TopA';'08-05-2016_01_39_10_TopB';'08-05-2016_01_38_18_TopA';'08-05-2016_01_38_18_TopB';'08-05-2016_01_37_26_TopA';'08-05-2016_01_37_26_TopB';'08-05-2016_01_36_35_TopA';'08-05-2016_01_36_35_TopB';'08-05-2016_01_35_42_TopA';'08-05-2016_01_35_42_TopB';'08-05-2016_01_34_50_TopA';'08-05-2016_01_34_50_TopB';'08-05-2016_01_33_07_TopA';'08-05-2016_01_33_07_TopB';'08-05-2016_01_32_14_TopA';'08-05-2016_01_32_14_TopB';'08-05-2016_01_31_22_TopA';'08-05-2016_01_31_22_TopB';'08-05-2016_01_28_47_TopA';'08-05-2016_01_28_47_TopB';'08-05-2016_01_27_03_TopA';'08-05-2016_01_27_03_TopB';'08-05-2016_01_25_19_TopA';'08-05-2016_01_25_19_TopB';'08-05-2016_01_24_27_TopA';'08-05-2016_01_24_27_TopB';'08-05-2016_01_23_35_TopA';'08-05-2016_01_23_35_TopB';'08-05-2016_01_22_43_TopA';'08-05-2016_01_22_43_TopB';'08-05-2016_01_21_35_TopA';'08-05-2016_01_21_35_TopB';'08-05-2016_01_20_43_TopA';'08-05-2016_01_20_43_TopB';'08-05-2016_01_19_52_TopA';'08-05-2016_01_19_52_TopB';'08-05-2016_01_19_00_TopA';'08-05-2016_01_19_00_TopB';'08-05-2016_01_18_08_TopA';'08-05-2016_01_18_08_TopB';'08-05-2016_01_17_16_TopA';'08-05-2016_01_17_16_TopB';'08-05-2016_01_16_24_TopA';'08-05-2016_01_16_24_TopB';'08-05-2016_01_15_32_TopA';'08-05-2016_01_15_32_TopB';'08-05-2016_01_14_40_TopA';'08-05-2016_01_14_40_TopB';'08-05-2016_01_13_48_TopA';'08-05-2016_01_13_48_TopB';'08-05-2016_01_12_56_TopA';'08-05-2016_01_12_56_TopB';'08-05-2016_01_12_04_TopA';'08-05-2016_01_12_04_TopB';'08-05-2016_01_11_12_TopA';'08-05-2016_01_11_12_TopB'};
filelist={'08-05-2016_02_25_48_TopA';'08-05-2016_02_25_48_TopB';'08-05-2016_02_24_56_TopA';'08-05-2016_02_24_56_TopB';'08-05-2016_02_23_34_TopA';'08-05-2016_02_23_34_TopB';'08-05-2016_02_22_42_TopA';'08-05-2016_02_22_42_TopB';'08-05-2016_02_21_50_TopA';'08-05-2016_02_21_50_TopB';'08-05-2016_02_20_58_TopA';'08-05-2016_02_20_58_TopB';'08-05-2016_02_20_06_TopA';'08-05-2016_02_20_06_TopB';'08-05-2016_02_19_14_TopA';'08-05-2016_02_19_14_TopB';'08-05-2016_02_18_22_TopA';'08-05-2016_02_18_22_TopB';'08-05-2016_02_17_30_TopA';'08-05-2016_02_17_30_TopB';'08-05-2016_02_15_46_TopA';'08-05-2016_02_15_46_TopB';'08-05-2016_02_14_37_TopA';'08-05-2016_02_14_37_TopB';'08-05-2016_02_12_18_TopA';'08-05-2016_02_12_18_TopB';'08-05-2016_02_11_26_TopA';'08-05-2016_02_11_26_TopB';'08-05-2016_02_10_34_TopA';'08-05-2016_02_10_34_TopB';'08-05-2016_02_09_42_TopA';'08-05-2016_02_09_42_TopB';'08-05-2016_02_08_50_TopA';'08-05-2016_02_08_50_TopB';'08-05-2016_02_07_58_TopA';'08-05-2016_02_07_58_TopB';'08-05-2016_02_07_06_TopA';'08-05-2016_02_07_06_TopB';'08-05-2016_02_06_14_TopA';'08-05-2016_02_06_14_TopB';'08-05-2016_02_05_22_TopA';'08-05-2016_02_05_22_TopB';'08-05-2016_02_03_51_TopA';'08-05-2016_02_03_51_TopB'};

folder='/Users/Zhenjie/Data/2016-08-04/';
%%
%filelist=filelist(1:2);
N=length(filelist);
filelistS1=filelist(1:2:N-1);
filelistS2=filelist(2:2:N);
%%
%Define the physical constant
mli=9.988346*10^-27;  %kg
hbar=1.0545718*10^(-34); %SI
hh=2*pi*hbar;%SI Planck constant
omega=23.9*2*pi; %in rad/s
pixellength=0.7*10^-6; %in m
sigma0=0.215*10^-12/2; %in m^2
%load all the functions
addpath('../Library');
Nsat=120;

%% Get the total atom number for S2 img;

ROI=[350,500,700,1000];
Z=ROI(2):ROI(4);
Z=Z';
zmin=400;zmax=1100;
indexS2=1:length(filelistS2);
imglistS2={};
numlistS2=[];
for i=1:length(filelistS2)
    tempimg=fitsread([folder,filelistS2{i},'.fits']);
    imglistS2=[imglistS2,tempimg];
    Nimg=AtomNumber(tempimg,pixellength^2,sigma0, Nsat);
    Nimg=Nimg(ROI(2):ROI(4),ROI(1):ROI(3));
    Nimg=CleanImage(Nimg);
    Nz=sum(Nimg,2);
    Nz=TailTailor(Nz,Z,zmin,zmax);
    numlistS2=[numlistS2;sum(Nz)];
    disp(i);
end
scatter(indexS2,numlistS2)
ylim([0,1.1*max(numlistS2)]);
xlabel('Img index');ylabel('Total Atom number');

%%
tolerance=0.05;
minscan=min(numlistS2);maxscan=max(numlistS2);
MeanNumlist=linspace(minscan,maxscan,40);
Npick=0*MeanNumlist;

for i=1:length(MeanNumlist)
    mask1=numlistS2<=(MeanNumlist(i)*(1+tolerance));
    mask2=numlistS2>=(MeanNumlist(i)*(1-tolerance));
    mask=mask1 & mask2;
    Npick(i)=sum(mask);
end
scatter(MeanNumlist,Npick);

[~,B]=max(Npick);
MeanNum=MeanNumlist(B);
mask1=numlistS2<=(MeanNum*(1+tolerance));
mask2=numlistS2>=(MeanNum*(1-tolerance));
mask=mask1 & mask2;

imglistS2pick1=imglistS2(mask);
filelistS2pick1=filelistS2(mask);
filelistS1pick1=filelistS1(mask);

%% Check the atom number for state 1

ROI=[350,300,700,1200];
Z=ROI(2):ROI(4);
Z=Z';
zmin=400;zmax=1100;
indexS1=1:length(filelistS1pick1);
imglistS1={};
numlistS1=[];
for i=1:length(filelistS1pick1)
    tempimg=fitsread([folder,filelistS1pick1{i},'.fits']);
    imglistS1=[imglistS1,tempimg];
    Nimg=AtomNumber(tempimg,pixellength^2,sigma0, Nsat);
    Nimg=Nimg(ROI(2):ROI(4),ROI(1):ROI(3));
    Nimg=CleanImage(Nimg);
    Nz=sum(Nimg,2);
    Nz=TailTailor(Nz,Z,zmin,zmax);
    numlistS1=[numlistS1;sum(Nz)];
    disp(i);
end
scatter(indexS1,numlistS1)
ylim([0,1.1*max(numlistS1)]);
xlabel('Img index');ylabel('Total Atom number');
%%
tolerance=0.05;
minscan=min(numlistS1);maxscan=max(numlistS1);
MeanNumlist=linspace(minscan,maxscan,40);
Npick=0*MeanNumlist;

for i=1:length(MeanNumlist)
    mask1=numlistS1<=(MeanNumlist(i)*(1+tolerance));
    mask2=numlistS1>=(MeanNumlist(i)*(1-tolerance));
    mask=mask1 & mask2;
    Npick(i)=sum(mask);
end
scatter(MeanNumlist,Npick);

[~,B]=max(Npick);
MeanNum=MeanNumlist(B);
mask1=numlistS1<=(MeanNum*(1+tolerance));
mask2=numlistS1>=(MeanNum*(1-tolerance));
mask=mask1 & mask2;

filelistS1pick2=filelistS1pick1(mask);
filelistS2pick2=filelistS2pick1(mask);
%%
ROI=[350,300,700,1200];
Z=ROI(2):ROI(4);
Z=Z';
zmin=400;zmax=1100;
Index=1:length(filelistS2pick2);
imglistS1Final={};
numlistS1Final=[];
imglistS2Final={};
numlistS2Final=[];

for i=1:length(filelistS1pick2)
    tempimgS1=fitsread([folder,filelistS1pick2{i},'.fits']);
    imglistS1Final=[imglistS1Final,tempimgS1];
    Nimg=AtomNumber(tempimgS1,pixellength^2,sigma0, Nsat);
    Nimg=Nimg(ROI(2):ROI(4),ROI(1):ROI(3));
    Nimg=CleanImage(Nimg);
    Nz=sum(Nimg,2);
    Nz=TailTailor(Nz,Z,zmin,zmax);
    numlistS1Final=[numlistS1Final;sum(Nz)];
    
    tempimgS2=fitsread([folder,filelistS2pick2{i},'.fits']);
    imglistS2Final=[imglistS2Final,tempimgS2];
    Nimg=AtomNumber(tempimgS2,pixellength^2,sigma0, Nsat);
    Nimg=Nimg(ROI(2):ROI(4),ROI(1):ROI(3));
    Nimg=CleanImage(Nimg);
    Nz=sum(Nimg,2);
    Nz=TailTailor(Nz,Z,zmin,zmax);
    numlistS2Final=[numlistS2Final;sum(Nz)];
    
    disp(i);
end
%%
scatter(Index,numlistS1Final);
hold on
scatter(Index,numlistS2Final);
hold off

filelistS1Final=filelistS1pick2;
filelistS2Final=filelistS2pick2;
%%
save('2016-08-04M.mat','imglistS1Final','imglistS2Final','filelistS1Final','filelistS2Final')
